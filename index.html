<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Supply Chain 4.0</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%); min-height: 100vh; padding: 20px; }
        .container { background: white; border-radius: 20px; box-shadow: 0 20px 60px rgba(0,0,0,0.3); max-width: 900px; width: 100%; margin: 0 auto; padding: 30px; }
        h1 { color: #1e3c72; text-align: center; margin-bottom: 10px; font-size: 2em; }
        .subtitle { text-align: center; color: #666; margin-bottom: 30px; font-size: 0.9em; }
        .screen { display: none; }
        .screen.active { display: block; }
        .btn { background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%); color: white; border: none; padding: 15px 30px; border-radius: 10px; font-size: 1.1em; cursor: pointer; width: 100%; margin-top: 20px; font-weight: bold; transition: transform 0.2s; }
        .btn:hover { transform: translateY(-2px); }
        .btn:disabled { background: #ccc; cursor: not-allowed; }
        .btn.secondary { background: #6c757d; }
        .input-group { margin: 20px 0; }
        .input-group label { display: block; color: #333; font-weight: bold; margin-bottom: 8px; }
        .input-group input { width: 100%; padding: 15px; border: 2px solid #ddd; border-radius: 10px; font-size: 1.1em; }
        .input-group input:focus { outline: none; border-color: #1e3c72; }
        .room-code-display { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 20px; border-radius: 15px; text-align: center; margin: 20px 0; font-size: 1.5em; font-weight: bold; letter-spacing: 3px; }
        .team-card { background: #f8f9fa; border: 2px solid #ddd; border-radius: 15px; padding: 20px; margin: 15px 0; cursor: pointer; transition: all 0.3s; }
        .team-card:hover { border-color: #1e3c72; transform: translateY(-3px); }
        .team-card.selected { border-color: #1e3c72; background: #e3f2fd; }
        .team-name { font-size: 1.3em; font-weight: bold; color: #1e3c72; margin-bottom: 10px; }
        .voting-section { background: #f8f9fa; padding: 20px; border-radius: 15px; margin: 20px 0; }
        .vote-option { display: flex; justify-content: space-between; align-items: center; padding: 15px; background: white; border: 2px solid #ddd; border-radius: 10px; margin: 10px 0; cursor: pointer; transition: all 0.3s; }
        .vote-option:hover { border-color: #1e3c72; }
        .vote-option.selected { border-color: #1e3c72; background: #e3f2fd; }
        .vote-count { background: #1e3c72; color: white; padding: 5px 15px; border-radius: 20px; font-weight: bold; }
        .leaderboard { background: #f8f9fa; padding: 20px; border-radius: 15px; margin: 20px 0; }
        .leaderboard h3 { color: #1e3c72; margin-bottom: 15px; text-align: center; }
        .leaderboard-item { display: flex; justify-content: space-between; align-items: center; padding: 15px; background: white; border-radius: 10px; margin: 10px 0; border-left: 4px solid #ccc; }
        .leaderboard-item.first { border-left-color: #ffd700; background: linear-gradient(90deg, #fffbea 0%, white 100%); }
        .rank { font-size: 1.5em; font-weight: bold; color: #1e3c72; min-width: 40px; }
        .score { font-size: 1.3em; font-weight: bold; color: #4caf50; }
        .info-box { background: #e3f2fd; padding: 15px; border-radius: 10px; margin: 20px 0; border-left: 4px solid #1e3c72; }
        .info-box h4 { color: #1e3c72; margin-bottom: 8px; }
        .player-chip { display: inline-block; background: #e3f2fd; color: #1e3c72; padding: 5px 15px; border-radius: 20px; font-size: 0.9em; margin: 5px; }
        .grid-2 { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
        .stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)); gap: 12px; margin: 20px 0; }
        .stat-card { background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%); padding: 12px; border-radius: 10px; text-align: center; }
        .stat-label { font-size: 0.75em; color: #666; margin-bottom: 5px; font-weight: 600; }
        .stat-value { font-size: 1.5em; font-weight: bold; color: #1e3c72; }
        .budget-bar { background: #e0e0e0; height: 30px; border-radius: 15px; margin: 20px 0; overflow: hidden; }
        .budget-fill { background: linear-gradient(90deg, #4caf50 0%, #8bc34a 100%); height: 100%; display: flex; align-items: center; justify-content: center; color: white; font-weight: bold; font-size: 0.9em; transition: width 0.3s; }
        .scenario { background: #f8f9fa; padding: 20px; border-radius: 10px; margin: 20px 0; border-left: 4px solid #1e3c72; }
        .scenario h3 { color: #333; margin-bottom: 10px; }
        .scenario p { color: #666; line-height: 1.6; margin-bottom: 15px; }
        .scenario-context { background: #fff3e0; padding: 15px; border-radius: 8px; margin: 15px 0; border-left: 3px solid #ff9800; }
        .scenario-context strong { color: #e65100; }
        .options { display: flex; flex-direction: column; gap: 10px; margin-top: 15px; }
        .option-btn { background: white; border: 2px solid #1e3c72; color: #333; padding: 15px; border-radius: 10px; cursor: pointer; text-align: left; font-size: 0.95em; transition: all 0.3s; }
        .option-btn:hover:not(:disabled) { background: #e3f2fd; transform: translateX(5px); }
        .option-btn:disabled { opacity: 0.5; cursor: not-allowed; }
        .option-cost { display: inline-block; background: #e3f2fd; color: #1976d2; padding: 3px 8px; border-radius: 12px; font-size: 0.85em; font-weight: bold; margin-left: 8px; }
        .feedback { margin-top: 15px; padding: 15px; border-radius: 10px; display: none; }
        .feedback.show { display: block; }
        .feedback.best { background: #e8f5e9; border-left: 4px solid #4caf50; color: #2e7d32; }
        .feedback.good { background: #fff9c4; border-left: 4px solid #fbc02d; color: #f57f17; }
        .feedback.poor { background: #ffebee; border-left: 4px solid #f44336; color: #c62828; }
        .loading { text-align: center; padding: 40px; color: #1e3c72; }
        
        .timer-container { text-align: center; margin: 20px 0; }
        .timer { display: inline-block; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 20px 40px; border-radius: 15px; font-size: 3em; font-weight: bold; min-width: 150px; box-shadow: 0 10px 30px rgba(102, 126, 234, 0.4); transition: all 0.3s; }
        .timer.warning { background: linear-gradient(135deg, #ff9800 0%, #f57c00 100%); animation: pulse 1s infinite; }
        .timer.danger { background: linear-gradient(135deg, #f44336 0%, #d32f2f 100%); animation: pulse 0.5s infinite; }
        @keyframes pulse { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.05); } }
        .timer-label { display: block; font-size: 0.9em; color: #666; margin-bottom: 10px; font-weight: bold; }
        
        .can-change-vote { background: #fff3e0; padding: 10px; border-radius: 8px; margin-top: 10px; text-align: center; color: #e65100; font-size: 0.9em; }
        
        @media (max-width: 600px) { 
            .container { padding: 20px; } 
            h1 { font-size: 1.5em; } 
            .grid-2 { grid-template-columns: 1fr; }
            .timer { font-size: 2em; padding: 15px 30px; }
        }
    </style>
</head>
<body>
    <div class="container">
        <div id="loading-screen" class="loading">
            <h2>‚è≥ Cargando...</h2>
        </div>

        <div id="entry-screen" class="screen">
            <h1>üè≠ Supply Chain 4.0</h1>
            <p class="subtitle">Modo Multijugador</p>
            <div class="info-box">
                <h4>üéÆ ¬øC√≥mo funciona?</h4>
                <p>1. Crea sala o √∫nete<br>2. Forma equipo<br>3. Voten dificultad<br>4. ¬°Compitan contra el tiempo!</p>
            </div>
            <div class="grid-2">
                <button class="btn" onclick="showCreateRoom()">Crear Sala</button>
                <button class="btn secondary" onclick="showJoinRoom()">Unirse</button>
            </div>
            <div id="create-room-form" style="display: none;">
                <div class="input-group"><label>Nombre Sala:</label><input type="text" id="room-name-input" placeholder="Log√≠stica 101"></div>
                <div class="input-group"><label>Tu Nombre:</label><input type="text" id="host-name-input" placeholder="Tu nombre"></div>
                <button class="btn" onclick="createRoom()">Crear</button>
            </div>
            <div id="join-room-form" style="display: none;">
                <div class="input-group"><label>C√≥digo:</label><input type="text" id="room-code-input" placeholder="ABC123" style="text-transform: uppercase;" maxlength="6"></div>
                <div class="input-group"><label>Tu Nombre:</label><input type="text" id="player-name-input" placeholder="Tu nombre"></div>
                <button class="btn" onclick="joinRoom()">Unirse</button>
            </div>
        </div>

        <div id="lobby-screen" class="screen">
            <h1>Sala: <span id="lobby-room-name">...</span></h1>
            <div class="room-code-display">C√ìDIGO: <span id="room-code-display">...</span></div>
            <div class="info-box"><h4>üì± Compartir</h4><p>Comparte el c√≥digo</p></div>
            <div id="pre-team-section">
                <h3 style="color: #1e3c72; margin: 20px 0;">Jugadores:</h3>
                <div id="players-waiting-list"></div>
                <div class="input-group"><label>Nombre Equipo:</label><input type="text" id="team-name-input" placeholder="Los Log√≠sticos"></div>
                <button class="btn" onclick="createTeam()">Crear Equipo</button>
                <div style="margin-top: 30px;"><h3 style="color: #1e3c72;">Equipos:</h3><div id="teams-list"></div></div>
            </div>
            <div id="team-formed-section" style="display: none;">
                <h3 style="color: #1e3c72; margin: 20px 0;">Tu equipo: <span id="my-team-name"></span></h3>
                <div class="team-card"><div id="my-team-members"></div></div>
                <div class="voting-section">
                    <h3 style="color: #1e3c72; margin-bottom: 15px;">üó≥Ô∏è Vota Dificultad</h3>
                    <p style="color: #666; margin-bottom: 10px;">Puedes cambiar tu voto</p>
                    <div class="vote-option" onclick="vote('easy')"><div><strong>üòä Principiante</strong><br><span style="font-size: 0.9em; color: #666;">$800K | ‚è±Ô∏è 30s por decisi√≥n</span></div><div class="vote-count" id="votes-easy">0</div></div>
                    <div class="vote-option" onclick="vote('normal')"><div><strong>üéØ Normal</strong><br><span style="font-size: 0.9em; color: #666;">$600K | ‚è±Ô∏è 25s por decisi√≥n</span></div><div class="vote-count" id="votes-normal">0</div></div>
                    <div class="vote-option" onclick="vote('hard')"><div><strong>üî• Experto</strong><br><span style="font-size: 0.9em; color: #666;">$400K | ‚è±Ô∏è 20s por decisi√≥n</span></div><div class="vote-count" id="votes-hard">0</div></div>
                    <div class="can-change-vote" id="my-vote-display" style="display: none;">
                        Tu voto: <strong id="my-vote-text"></strong> - Click para cambiar
                    </div>
                </div>
                <div class="info-box" id="waiting-message"><h4>‚è≥ Esperando...</h4></div>
                <button class="btn" id="start-game-btn" onclick="startMultiplayerGame()" style="display: none;">¬°Comenzar!</button>
            </div>
            <div class="leaderboard"><h3>üìä Equipos</h3><div id="all-teams-list"></div></div>
        </div>

        <div id="game-screen" class="screen">
            <h1>Supply Chain 4.0</h1>
            <p class="subtitle">Equipo: <span id="playing-team-name"></span></p>
            
            <div class="timer-container">
                <span class="timer-label">‚è±Ô∏è TIEMPO RESTANTE</span>
                <div id="timer" class="timer">--</div>
            </div>

            <div class="budget-bar"><div id="budget-fill" class="budget-fill">$<span id="budget-text">600</span>K</div></div>
            <div class="stats-grid">
                <div class="stat-card"><div class="stat-label">‚ö° Eficiencia</div><div id="efficiency" class="stat-value">65%</div></div>
                <div class="stat-card"><div class="stat-label">üí∞ Costos</div><div id="costs" class="stat-value">$450K</div></div>
                <div class="stat-card"><div class="stat-label">üòä Satisfacci√≥n</div><div id="satisfaction" class="stat-value">72%</div></div>
                <div class="stat-card"><div class="stat-label">üå± Sostenibilidad</div><div id="sustainability" class="stat-value">60%</div></div>
            </div>
            <div id="scenario-container"></div>
        </div>

        <div id="results-screen" class="screen">
            <h1>üèÜ Resultados</h1>
            <div class="info-box">
                <h4>Equipo: <span id="results-team-name"></span></h4>
                <p style="font-size: 1.3em; color: #1e3c72; font-weight: bold; margin-top: 10px;">
                    Puntos Totales: <span id="results-team-score"></span>
                </p>
                <p style="margin-top: 10px; color: #666;">
                    Bonus por tiempo: <strong style="color: #4caf50;">+<span id="time-bonus">0</span> pts</strong>
                </p>
            </div>
            <div class="leaderboard"><h3>üèÜ Clasificaci√≥n</h3><div id="final-leaderboard"></div></div>
            <button class="btn" onclick="backToLobby()">Volver</button>
            <button class="btn secondary" onclick="location.reload()">Nueva Sala</button>
        </div>
    </div>

    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    <script>
        let db, currentRoom, currentPlayer, currentTeam, roomListener;
        let timerInterval = null;
        let timeRemaining = 0;
        let timeLimit = 0;
        let totalTimeBonus = 0;

        const scenariosByDifficulty = {
            easy: [
                {title: "üöö Crisis del Canal de Suez", company: "Caso Real 2021", description: "Tus productos est√°n varados por el bloqueo del canal. Los clientes cancelan pedidos. ¬øC√≥mo respondes?", options: [
                    {text: "Implementar IoT + IA para encontrar rutas alternativas autom√°ticamente", cost: 80, impacts: {efficiency: 15, costs: -40, satisfaction: 12, sustainability: -5}, quality: "best", feedback: "¬°Excelente! Sistema predictivo optimizado.", points: 25},
                    {text: "Enviar todo por avi√≥n sin an√°lisis de costos", cost: 150, impacts: {efficiency: -10, costs: 80, satisfaction: 8, sustainability: -20}, quality: "poor", feedback: "Muy costoso e insostenible.", points: 5},
                    {text: "Esperar a que se resuelva y comunicar a clientes", cost: 20, impacts: {efficiency: -8, costs: -10, satisfaction: -5, sustainability: 5}, quality: "good", feedback: "Honesto pero reactivo.", points: 15}
                ]},
                {title: "üìä Predicci√≥n de Demanda", company: "Inspirado en Amazon", description: "Temporada alta se aproxima. ¬øC√≥mo gestionas el inventario?", options: [
                    {text: "IA + Big Data para predicci√≥n autom√°tica", cost: 90, impacts: {efficiency: 20, costs: -60, satisfaction: 15, sustainability: 8}, quality: "best", feedback: "94% de precisi√≥n alcanzada", points: 25},
                    {text: "Seguir patrones del a√±o anterior manualmente", cost: 10, impacts: {efficiency: -5, costs: 15, satisfaction: -8, sustainability: -10}, quality: "poor", feedback: "M√©todo obsoleto para Supply Chain 4.0", points: 5}
                ]},
                {title: "‚õìÔ∏è Trazabilidad de Productos", company: "Inspirado en Walmart", description: "Cliente importante exige certificaci√≥n √©tica de proveedores. ¬øQu√© implementas?", options: [
                    {text: "Blockchain + Smart Contracts para trazabilidad", cost: 85, impacts: {efficiency: 10, costs: -30, satisfaction: 20, sustainability: 18}, quality: "best", feedback: "Transparencia total e inmutable", points: 25},
                    {text: "Sistema de certificados PDF tradicionales", cost: 15, impacts: {efficiency: -5, costs: 10, satisfaction: -8, sustainability: -5}, quality: "poor", feedback: "Poco confiable y f√°cil de falsificar", points: 5}
                ]}
            ],
            normal: [
                {title: "üè≠ Optimizaci√≥n de Producci√≥n Multi-Planta", company: "Caso Siemens", description: "Tienes 5 plantas en 3 continentes con diferente capacidad. Pedido urgente de 50,000 unidades en 2 semanas. Algunas plantas tienen problemas de calidad.", options: [
                    {text: "Digital Twin de todas las plantas para simular escenarios y optimizar asignaci√≥n con IA considerando calidad, capacidad y log√≠stica", cost: 120, impacts: {efficiency: 18, costs: -50, satisfaction: 18, sustainability: 10}, quality: "best", feedback: "Optimizaci√≥n integral con simulaci√≥n en tiempo real", points: 30},
                    {text: "Distribuir carga proporcionalmente seg√∫n capacidad instalada sin considerar otros factores cr√≠ticos", cost: 40, impacts: {efficiency: -5, costs: 20, satisfaction: -10, sustainability: -8}, quality: "poor", feedback: "Simplista, ignora problemas de calidad y log√≠stica", points: 8},
                    {text: "Sistema MES tradicional con an√°lisis manual de capacidades y llamadas a gerentes de planta", cost: 60, impacts: {efficiency: 5, costs: 10, satisfaction: 5, sustainability: 0}, quality: "good", feedback: "Funcional pero lento, no usa potencial de 4.0", points: 18}
                ]},
                {title: "üì¶ Crisis de √öltima Milla", company: "Caso DHL", description: "70% de entregas se retrasan en zonas urbanas por tr√°fico y falta de coordinaci√≥n. Clientes amenazan con cambiar de proveedor.", options: [
                    {text: "IA para ruteo din√°mico + IoT en veh√≠culos + predicci√≥n de tr√°fico en tiempo real + micro-hubs urbanos automatizados", cost: 140, impacts: {efficiency: 22, costs: -55, satisfaction: 25, sustainability: 15}, quality: "best", feedback: "Reducci√≥n 65% en tiempos, soluci√≥n integral 4.0", points: 30},
                    {text: "Contratar m√°s conductores y veh√≠culos sin cambiar el sistema operativo", cost: 100, impacts: {efficiency: -8, costs: 60, satisfaction: 3, sustainability: -18}, quality: "poor", feedback: "Soluci√≥n costosa que no ataca el problema ra√≠z", points: 8},
                    {text: "Software b√°sico de ruteo con actualizaciones cada hora y redistribuci√≥n manual de rutas", cost: 70, impacts: {efficiency: 8, costs: 5, satisfaction: 8, sustainability: -5}, quality: "good", feedback: "Mejora moderada pero no aprovecha tecnolog√≠a 4.0", points: 18}
                ]},
                {title: "üîÑ Gesti√≥n de Devoluciones", company: "Caso Reverse Logistics", description: "15% de productos se devuelven. Proceso manual toma 3 semanas. P√©rdidas de $2M/a√±o por productos que no se reintegran a tiempo al inventario.", options: [
                    {text: "Plataforma automatizada con IA para clasificaci√≥n, Blockchain para tracking, robots para inspecci√≥n, y reintegraci√≥n autom√°tica al inventario disponible", cost: 110, impacts: {efficiency: 20, costs: -65, satisfaction: 20, sustainability: 22}, quality: "best", feedback: "Reducci√≥n 80% en tiempo, recuperaci√≥n 95% del valor", points: 30},
                    {text: "Mantener proceso manual pero contratar m√°s personal para acelerar inspecciones", cost: 50, impacts: {efficiency: -3, costs: 35, satisfaction: 5, sustainability: -5}, quality: "poor", feedback: "No escala, sigue siendo ineficiente", points: 8},
                    {text: "Sistema WMS con m√≥dulo de devoluciones y lectores de c√≥digo de barras para seguimiento", cost: 75, impacts: {efficiency: 10, costs: 10, satisfaction: 12, sustainability: 5}, quality: "good", feedback: "Digitaliza pero no optimiza completamente", points: 18}
                ]},
                {title: "üåê Visibilidad de Supply Chain Global", company: "Caso Maersk", description: "Tienes 200 proveedores en 35 pa√≠ses. Solo conoces el estado de 30% de tus env√≠os. Problemas se descubren cuando ya es tarde.", options: [
                    {text: "Control Tower digital con IoT en todos los env√≠os, IA predictiva de riesgos, integraci√≥n API con proveedores, y alertas autom√°ticas en tiempo real", cost: 130, impacts: {efficiency: 25, costs: -70, satisfaction: 22, sustainability: 12}, quality: "best", feedback: "Visibilidad 98%, predicci√≥n de problemas con 72hrs de anticipaci√≥n", points: 30},
                    {text: "Pedir reportes diarios por email a cada proveedor y consolidarlos en Excel", cost: 20, impacts: {efficiency: -10, costs: 5, satisfaction: -12, sustainability: -8}, quality: "poor", feedback: "Informaci√≥n desactualizada, imposible de analizar en tiempo real", points: 8},
                    {text: "Sistema TMS con integraci√≥n EDI para los proveedores principales y reportes semanales", cost: 80, impacts: {efficiency: 12, costs: 0, satisfaction: 10, sustainability: 5}, quality: "good", feedback: "Mejora visibilidad pero no es tiempo real ni predictivo", points: 18}
                ]}
            ],
            hard: [
                {title: "‚ö° Redise√±o de Red Log√≠stica Global", company: "Caso Multinacional", description: "Tu red tiene 15 DCs, 8 plantas, 500 distribuidores. An√°lisis muestra ineficiencias: 40% de movimientos no agregan valor, costos 25% sobre benchmark. Necesitas redise√±o estrat√©gico.", options: [
                    {text: "Implementar an√°lisis con optimizaci√≥n matem√°tica multi-objetivo considerando 15 variables (costos, tiempos, carbono, resiliencia, capacidades). Usar simulaci√≥n Monte Carlo con 10,000 iteraciones para validar escenarios. Integrar restricciones regulatorias de 8 pa√≠ses. Dise√±ar red con nodos redundantes para mitigar riesgos geopol√≠ticos. Implementaci√≥n faseada en 18 meses con KPIs intermedios.", cost: 180, impacts: {efficiency: 28, costs: -85, satisfaction: 20, sustainability: 25}, quality: "best", feedback: "Redise√±o integral basado en optimizaci√≥n avanzada y an√°lisis de riesgos. Reducci√≥n 32% costos totales, mejora 45% en resiliencia.", points: 35},
                    {text: "Utilizar software de optimizaci√≥n de red que considera costos de transporte, capacidades de almacenes y vol√∫menes hist√≥ricos. Aplicar modelo de gravedad para asignaci√≥n de demanda. Evaluar 5 escenarios principales de configuraci√≥n de red. Validar con datos de √∫ltimos 2 a√±os. Plan de implementaci√≥n de 12 meses con enfoque en quick wins primero.", cost: 175, impacts: {efficiency: 22, costs: -60, satisfaction: 15, sustainability: 18}, quality: "good", feedback: "Optimizaci√≥n s√≥lida pero no considera factores cr√≠ticos como resiliencia, sostenibilidad o escenarios de riesgo avanzados. Implementaci√≥n acelerada puede generar problemas operativos.", points: 22},
                    {text: "Contratar consultora estrat√©gica para an√°lisis completo de 6 meses. Desarrollar heat maps de costos y tiempos. Benchmarking con 20 empresas del sector. Dise√±o conceptual de red √≥ptima basado en best practices de industria. Roadmap de transformaci√≥n con gobernanza y gesti√≥n de cambio. Pilotos en 2 regiones antes de escalar globalmente.", cost: 185, impacts: {efficiency: 18, costs: -45, satisfaction: 18, sustainability: 15}, quality: "good", feedback: "Enfoque metodol√≥gico robusto con gesti√≥n de cambio, pero an√°lisis prolongado retrasa beneficios. No incorpora suficiente anal√≠tica avanzada ni simulaci√≥n de escenarios complejos.", points: 20},
                    {text: "An√°lisis ABC de SKUs y consolidaci√≥n de 40% de productos de menor rotaci√≥n. Cerrar 3 DCs de menor volumen y redistribuir a instalaciones restantes. Renegociar contratos de transporte para obtener descuentos por volumen. Implementar WMS est√°ndar en todas las instalaciones. Proyecto de 9 meses enfocado en reducci√≥n de costos operativos directos y footprint de red.", cost: 170, impacts: {efficiency: 12, costs: -30, satisfaction: 5, sustainability: 8}, quality: "poor", feedback: "Enfoque t√°ctico de reducci√≥n de costos sin redise√±o estrat√©gico. Cierre de instalaciones sin an√°lisis de nivel de servicio puede afectar clientes. No considera crecimiento futuro ni tecnolog√≠as 4.0.", points: 12}
                ]},
                {title: "ü§ñ Automatizaci√≥n de Almac√©n de Alto Volumen", company: "Caso E-commerce", description: "Almac√©n procesa 200K pedidos/d√≠a. Picos de 350K en temporada alta. Precisi√≥n 94%. Costos de mano de obra $12M/a√±o. Accidentalidad 15% sobre promedio industria. Necesitas transformaci√≥n.", options: [
                    {text: "Desplegar soluci√≥n integral: AutoStore o Kiva para almacenamiento denso, robots AMR para picking colaborativo, visi√≥n artificial + IA para control de calidad automatizado, WMS con machine learning para optimizaci√≥n de slotting din√°mico. Exoesqueletos para trabajadores en √°reas no automatizadas. Sistema de gesti√≥n de energ√≠a para reducir consumo en 40%. Programa de reskilling para operadores hacia roles de supervisi√≥n t√©cnica. ROI 3.2 a√±os.", cost: 190, impacts: {efficiency: 32, costs: -90, satisfaction: 25, sustainability: 28}, quality: "best", feedback: "Automatizaci√≥n inteligente que combina robots, IA y personas. Aumenta capacidad 180%, reduce costos 45%, elimina 89% de accidentes. Modelo sostenible social y ambientalmente.", points: 35},
                    {text: "Implementar sistema AS/RS para almacenamiento vertical automatizado. Transportadores y sorters para movimiento de producto. Put-to-light para picking. Integraci√≥n con WMS existente mediante middleware. Mantener estructura organizacional actual con reducci√≥n gradual de personal v√≠a attrition. Sistema de seguridad mejorado con sensores. Payback 4 a√±os con enfoque en maximizar throughput y minimizar errores de inventario.", cost: 185, impacts: {efficiency: 25, costs: -65, satisfaction: 18, sustainability: 15}, quality: "good", feedback: "Automatizaci√≥n efectiva pero tecnolog√≠a convencional. No incorpora IA ni machine learning. Enfoque en throughput sin optimizaci√≥n hol√≠stica. Gesti√≥n de personal reactiva en lugar de proactiva.", points: 22},
                    {text: "Robots colaborativos (cobots) para tareas repetitivas de picking. Sistema de voice picking para mejorar productividad. Optimizaci√≥n de layouts con an√°lisis de flujos. WMS con funcionalidades avanzadas de olas y ruteo. Incrementar capacitaci√≥n y programas de incentivos para retenci√≥n de personal. Mejoras ergon√≥micas para reducir accidentalidad. Monitoreo con dashboards en tiempo real. Inversi√≥n escalonada en 24 meses.", cost: 180, impacts: {efficiency: 20, costs: -50, satisfaction: 15, sustainability: 18}, quality: "good", feedback: "Enfoque balanceado entre tecnolog√≠a y personas. Cobots ayudan pero no transforman operaci√≥n. No alcanza capacidad para picos futuros. Mejoras incrementales vs transformaci√≥n radical.", points: 20},
                    {text: "Redise√±ar procesos operativos con metodolog√≠a Lean. Implementar zones de picking optimizadas. Sistema de gesti√≥n de mano de obra (LMS) para productividad. Contratar workforce flexible (gig workers) para picos estacionales mediante plataformas digitales. Actualizar WMS a versi√≥n cloud. Programa de certificaci√≥n de operadores. Crear KPIs en tiempo real con alertas. Mejora continua con equipo Kaizen dedicado. Approach iterativo sin automatizaci√≥n pesada.", cost: 175, impacts: {efficiency: 15, costs: -35, satisfaction: 12, sustainability: 10}, quality: "poor", feedback: "Optimizaci√≥n de procesos sin automatizaci√≥n significativa. En operaciones de alto volumen, mejoras lean tienen l√≠mites. No resuelve problema estructural de escalabilidad. Dependencia de mano de obra sigue siendo riesgo en mercado laboral tenso.", points: 12}
                ]},
                {title: "üîê Ciberseguridad en Supply Chain Conectada", company: "Caso cr√≠tico", description: "Has implementado IoT en 5,000 dispositivos, cloud para 80% de operaciones, conexiones con 150 partners externos. Auditor√≠a detecta 47 vulnerabilidades cr√≠ticas. Industria tuvo 3 ataques de ransomware este a√±o con p√©rdidas promedio de $18M.", options: [
                    {text: "Arquitectura Zero Trust con micro-segmentaci√≥n de red, autenticaci√≥n multi-factor obligatoria en todos los accesos, encriptaci√≥n end-to-end de datos en tr√°nsito y reposo. SIEM con IA para detecci√≥n de amenazas en tiempo real y respuesta autom√°tica. Blockchain para asegurar integridad de transacciones cr√≠ticas. Red-team exercises trimestrales. SOC 24/7 con threat intelligence. Programa de awareness continuo. Cyber insurance con cobertura de $50M. Compliance con ISO 27001 y NIST Framework. Disaster recovery con RPO<1hr.", cost: 165, impacts: {efficiency: 15, costs: -40, satisfaction: 22, sustainability: 8}, quality: "best", feedback: "Estrategia comprehensiva multi-capa. Combina tecnolog√≠a, procesos y personas. Detecta 98% de amenazas, respuesta autom√°tica reduce tiempo de contenci√≥n en 85%. Protege reputaci√≥n y continuidad operativa.", points: 35},
                    {text: "Implementar firewall de pr√≥xima generaci√≥n (NGFW) en todos los puntos de acceso. Sistema de gesti√≥n de identidades (IAM) con SSO corporativo. Antivirus en endpoints y servidores. Pol√≠ticas de seguridad documentadas y revisi√≥n anual. Backups diarios con retenci√≥n de 30 d√≠as. Segmentaci√≥n b√°sica de red por VLANs. Capacitaci√≥n anual de ciberseguridad para empleados. An√°lisis de vulnerabilidades semestral con remediaci√≥n de cr√≠ticos en 30 d√≠as. Respaldo de aplicaciones cr√≠ticas en site secundario.", cost: 160, impacts: {efficiency: 10, costs: -25, satisfaction: 15, sustainability: 5}, quality: "good", feedback: "Seguridad perimetral s√≥lida pero insuficiente para amenazas avanzadas. No hay detecci√≥n proactiva ni respuesta autom√°tica. Backups ayudan pero RPO de 24hrs puede ser cr√≠tico. Capacitaci√≥n anual es insuficiente.", points: 22},
                    {text: "Contratar MSSP (Managed Security Service Provider) para monitoreo 24/7 de infraestructura cloud y on-premise. Implementar EDR en todos los endpoints con machine learning para detecci√≥n de comportamientos an√≥malos. Actualizaci√≥n autom√°tica de parches cr√≠ticos. Pol√≠ticas de acceso basadas en roles (RBAC). Simulacros de ransomware bi-anuales. Seguro cibern√©tico con cobertura b√°sica. Documentaci√≥n de plan de respuesta a incidentes. Auditor√≠as de cumplimiento anuales. Segregaci√≥n de ambientes de desarrollo, test y producci√≥n.", cost: 158, impacts: {efficiency: 12, costs: -30, satisfaction: 18, sustainability: 6}, quality: "good", feedback: "Tercerizaci√≥n del monitoreo es efectiva pero transfiere responsabilidad sin desarrollar capacidad interna. EDR es bueno pero sin SIEM integrado pierde visibilidad hol√≠stica. Plan de respuesta ayuda pero falta automatizaci√≥n.", points: 20},
                    {text: "Actualizar todos los sistemas a √∫ltimas versiones con parches de seguridad. Cambiar contrase√±as corporativas a est√°ndares m√°s robustos con pol√≠tica de renovaci√≥n trimestral. Desactivar puertos USB en computadoras corporativas. Filtro de contenido web para bloquear sitios maliciosos. Antivirus corporativo en todos los dispositivos. Backup semanal en disco externo. Capacitaci√≥n b√°sica de phishing por email. Restricci√≥n de instalaci√≥n de software sin aprobaci√≥n de IT. Revisi√≥n manual de logs mensualmente para detectar actividades sospechosas.", cost: 155, impacts: {efficiency: 8, costs: -15, satisfaction: 10, sustainability: 3}, quality: "poor", feedback: "Medidas b√°sicas de higiene cibern√©tica que cualquier empresa deber√≠a tener. Insuficiente para Supply Chain 4.0 conectada. Revisi√≥n manual de logs es inviable a escala. Backup semanal deja ventana de p√©rdida de datos de 7 d√≠as inaceptable.", points: 12}
                ]},
                {title: "üìä Planificaci√≥n Integrada (S&OP 4.0)", company: "Caso Unilever", description: "Ciclo S&OP toma 4 semanas, involucra 50 personas, 200 hojas Excel, 30 reuniones. Forecast accuracy 65%. Exceso de inventario $45M, faltantes cuestan $12M en ventas perdidas. Desconexi√≥n entre comercial, operaciones y finanzas.", options: [
                    {text: "Plataforma de Integrated Business Planning (IBP) con IA generativa para crear m√∫ltiples escenarios autom√°ticamente. Machine learning para forecast con precisi√≥n 88%. What-if analysis en tiempo real considerando 25 variables simult√°neas. Integraci√≥n autom√°tica de datos de ERP, CRM, market intelligence y weather patterns. Colaboraci√≥n digital as√≠ncrona eliminando 80% de reuniones. Optimizaci√≥n simult√°nea de ingresos, m√°rgenes, capital de trabajo y servicio al cliente. Dashboards ejecutivos con narrativas autom√°ticas en lenguaje natural. Ciclo S&OP de 5 d√≠as.", cost: 170, impacts: {efficiency: 30, costs: -80, satisfaction: 28, sustainability: 20}, quality: "best", feedback: "Transformaci√≥n completa de S&OP a IBP 4.0. Velocidad 6x mayor, precisi√≥n +23pp, reduce inventario 35% mientras mejora servicio. Decisiones basadas en simulaciones vs opiniones. ROI 8 meses.", points: 35},
                    {text: "Software de demand planning con algoritmos estad√≠sticos avanzados (ARIMA, exponential smoothing, ensemble models). Cubos OLAP para an√°lisis multidimensional r√°pido. Workflows digitales para aprobaciones y colaboraci√≥n. Consolidaci√≥n autom√°tica de datos desde sistemas fuente. Portal de visualizaci√≥n con drill-down capabilities. Repositorio centralizado eliminando Excels dispersos. Proceso estructurado de 2 semanas con meetings virtuales. Consensus forecast con ponderaci√≥n estad√≠stica de inputs. KPIs automatizados con alertas de excepciones.", cost: 165, impacts: {efficiency: 22, costs: -55, satisfaction: 20, sustainability: 12}, quality: "good", feedback: "Modernizaci√≥n significativa del proceso S&OP. Mejora precisi√≥n y reduce tiempo 50%. Pero algoritmos estad√≠sticos solos no capturan cambios de mercado complejos. Falta optimizaci√≥n financiera integrada y capacidades prescriptivas de IA.", points: 22},
                    {text: "Implementar aplicaci√≥n cloud de S&OP con templates predefinidos y best practices de industria. Conectores pre-construidos a sistemas ERP principales. Demand sensing con data de POS cuando disponible. Collaborative portal para que stakeholders ingresen inputs. Biblioteca de forecasts hist√≥ricos para an√°lisis de accuracy. Supply planning con ATP/CTP checks automatizados. Financial planning b√°sico integrado. Reducir meetings a semanales en lugar de ad-hoc. Roles y responsabilidades claras documentadas. Training program de 2 semanas para usuarios.", cost: 162, impacts: {efficiency: 18, costs: -45, satisfaction: 16, sustainability: 10}, quality: "good", feedback: "Digitalizaci√≥n efectiva que reduce caos de Excel y mejora colaboraci√≥n. Template approach acelera implementaci√≥n pero puede ser r√≠gido. Demand sensing ayuda pero sin ML avanzado accuracy mejora limitadamente. No optimiza trade-offs complejos.", points: 20},
                    {text: "Consolidar datos en una macro de Excel robusta con conexi√≥n ODBC a sistemas. Crear templates estandarizados para cada √°rea (comercial, ops, finanzas). Establecer calendario fijo de meetings con agenda estructurada. Nombrar S&OP champion que coordine proceso y haga seguimiento. Implementar simple moving average y seasonal adjustment para forecast base. Dashboard en PowerBI para visualizar KPIs principales. Documentar proceso en manual de procedimientos. Sesi√≥n mensual ejecutiva de revisi√≥n y aprobaci√≥n. M√©trica de forecast accuracy con reporte mensual de performance.", cost: 158, impacts: {efficiency: 12, costs: -25, satisfaction: 10, sustainability: 5}, quality: "poor", feedback: "Intento de mejorar con herramientas disponibles pero sigue siendo fundamentalmente manual. Excel no escala para complejidad de negocio moderno. Forecast simplista no captura patrones reales. Proceso sigue siendo lento y propenso a errores humanos.", points: 12}
                ]},
                {title: "üå± Supply Chain Circular y Sostenible", company: "Caso Philips", description: "Regulaci√≥n europea exige 65% de material reciclado para 2026. Clientes corporativos exigen certificaci√≥n carbono neutral. Inversores eval√∫an ESG. Actual: 12% reciclado, huella 350K ton CO2/a√±o, 40% packaging no reciclable, log√≠stica inversa inexistente.", options: [
                    {text: "Dise√±ar modelo de econom√≠a circular end-to-end: redise√±o de productos para facilitar desensamble y reciclaje (Design for Circularity), material passport digital con Blockchain para rastrear componentes, plataforma digital de reverse logistics con incentivos para devoluci√≥n de productos al fin de vida √∫til, plantas de refurbishment automatizadas con IA para clasificaci√≥n, partnerships estrat√©gicos con recicladores certificados, transici√≥n a packaging 100% compostable o reciclable, optimizaci√≥n de rutas para reducir 45% emisiones de transporte, compensaci√≥n de carbono residual con proyectos verificados, certificaciones B-Corp y Cradle-to-Cradle, reporting ESG seg√∫n GRI y SASB con auditor√≠a externa.", cost: 195, impacts: {efficiency: 20, costs: -60, satisfaction: 30, sustainability: 45}, quality: "best", feedback: "Transformaci√≥n sist√©mica a modelo circular. Alcanza 70% reciclado, carbono neutral certificado, diferenciaci√≥n competitiva sustancial. Valorizaci√≥n de marca +22%. Atrae inversi√≥n ESG y nuevos clientes corporativos. Modelo replicable y escalable.", points: 35},
                    {text: "Programa de sostenibilidad con m√∫ltiples workstreams: cambiar proveedores de materias primas a opciones con mayor contenido reciclado cuando disponibles comercialmente, implementar sistema de recolecci√≥n de productos usados en principales mercados con incentivo econ√≥mico, establecer centro de refurbishment manual para productos high-value, cambiar a packaging reciclable para 80% de portfolio, optimizar consolidaci√≥n de env√≠os para reducir emisiones 25%, adquirir RECs (Renewable Energy Credits) para operaciones, publicar reporte de sostenibilidad anual con metas p√∫blicas, certificaci√≥n ISO 14001, participar en iniciativas de industria como Pacto Global ONU.", cost: 188, impacts: {efficiency: 15, costs: -40, satisfaction: 22, sustainability: 32}, quality: "good", feedback: "Programa comprehensivo con m√∫ltiples iniciativas. Avance significativo pero no alcanza metas de regulaci√≥n (65%). Refurbishment manual no escala eficientemente. RECs compensan pero no eliminan emisiones. Falta innovaci√≥n radical en modelo de negocio circular.", points: 22},
                    {text: "Iniciativa de sostenibilidad enfocada: trabajar con proveedores Tier 1 para incrementar uso de materiales reciclados gradualmente a√±o tras a√±o, lanzar programa piloto de take-back en 2 pa√≠ses con log√≠stica subcontratada a 3PL existente, evaluar opciones de packaging alternativo con consultora especializada, medir huella de carbono actual seg√∫n Scope 1 y 2 del protocolo GHG, establecer meta de reducci√≥n 20% para 2030, comunicar esfuerzos de sostenibilidad en sitio web corporativo y redes sociales, formar comit√© interno de sostenibilidad con representantes de √°reas clave, asignar presupuesto incremental anual para proyectos verdes.", cost: 182, impacts: {efficiency: 10, costs: -28, satisfaction: 18, sustainability: 22}, quality: "good", feedback: "Inicio s√≥lido de journey de sostenibilidad. Piloto es apropiado para aprender, pero timeline largo no cumple urgencia regulatoria. Scope 1-2 es b√°sico, falta Scope 3 que es mayor√≠a de impacto. Comunicaci√≥n importante pero sin acci√≥n profunda es greenwashing risk.", points: 20},
                    {text: "Medidas b√°sicas de sostenibilidad: cambiar bombillas a LED en instalaciones, promover reciclaje interno de papel y pl√°stico en oficinas, reducir impresi√≥n con pol√≠tica de paperless, videoconferencias en lugar de viajes cuando sea posible para reducir emisiones, comprar algunos insumos de proveedores locales cuando el precio sea comparable, incluir mensaje de sostenibilidad en packaging existente, crear secci√≥n de sustentabilidad en p√°gina web listando esfuerzos, donar productos con defectos menores a organizaciones ben√©ficas en lugar de desechar, hacer campa√±a interna de concientizaci√≥n ambiental para empleados.", cost: 178, impacts: {efficiency: 5, costs: -15, satisfaction: 10, sustainability: 12}, quality: "poor", feedback: "Medidas de responsabilidad corporativa b√°sica que no atacan el challenge fundamental. No transforma supply chain ni modelo de negocio. Completamente insuficiente para cumplir regulaci√≥n 65%. No hay innovaci√≥n tecnol√≥gica ni de proceso. Riesgo de multas regulatorias y p√©rdida de clientes corporativos.", points: 12}
                ]},
                {title: "üéØ Respuesta a Disrupci√≥n de Startup Competidora", company: "Caso real industria", description: "Startup con $200M funding lanz√≥ modelo directo al consumidor, entrega 2hrs, AI personalization, precio 15% menor. En 8 meses captur√≥ 12% de tu mercado en millennial/Gen-Z. Tu modelo: distribuidores tradicionales, entrega 3-5 d√≠as, sin personalizaci√≥n, estructura de costos alta.", options: [
                    {text: "Transformaci√≥n integral multi-frente: (1) CANAL: crear marca digital separada (avoid cannibalization) con modelo D2C, micro-fulfillment centers urbanos para entregas <3hrs, (2) TECNOLOG√çA: plataforma e-commerce headless con mobile-first UX, AI engine para recomendaciones hyperpersonalizadas, pricing din√°mico con ML, (3) OPERACIONES: automatizaci√≥n de fulfillment con robots, integraci√≥n API con last-mile partners (Uber, couriers), (4) PRODUCTOS: SKU rationalization enfocado en long-tail digital, co-creation con comunidad online, (5) FINANCIERO: modelo freemium para acquisition, subscription para loyalty con beneficios exclusivos, (6) ORGANIZACIONAL: equipo dedicado digital con autonom√≠a, m√©tricas propias, hiring de talento tech/startup, cultura agile con sprints de 2 semanas. Inversi√≥n 18 meses.", cost: 200, impacts: {efficiency: 25, costs: -50, satisfaction: 35, sustainability: 15}, quality: "best", feedback: "Respuesta disruptiva que iguala o supera a startup. Modelo dual protege base actual mientras captura nuevos segmentos. Combinaci√≥n de velocidad operativa + capacidad financiera de incumbente es ventaja competitiva. Recupera share perdido y crece 25% en segmento digital.", points: 35},
                    {text: "Estrategia de transformaci√≥n digital acelerada: (1) Lanzar sitio de e-commerce transaccional integrado con inventario en tiempo real de red de distribuidores, (2) Alianza con plataforma de last-mile existente para ofrecer entregas same-day en ciudades principales, (3) Programa de loyalty digital con puntos y beneficios, (4) Implementar sistema de recomendaciones b√°sico usando historial de compras, (5) Optimizar pricing con an√°lisis competitivo sistem√°tico y ajustes mensuales, (6) Campa√±as de marketing digital targetizadas en redes sociales y Google, (7) Upskilling de equipo actual en competencias digitales, (8) Modernizaci√≥n de sistemas backend (ERP, WMS) para soportar omnicanalidad. Roadmap de 12 meses.", cost: 192, impacts: {efficiency: 18, costs: -35, satisfaction: 25, sustainability: 10}, quality: "good", feedback: "Transformaci√≥n significativa que cierra parte de gap competitivo. E-commerce integrado es correcto pero usar red existente de distribuidores limita velocidad vs micro-fulfillment dedicado. Loyalty y recomendaciones ayudan pero son table stakes. Falta innovaci√≥n radical en propuesta de valor y modelo operativo.", points: 22},
                    {text: "Respuesta competitiva pragm√°tica: (1) Mejorar e-commerce existente con UX m√°s moderna y checkout simplificado, (2) Negociar con distribuidores principales para ofrecer entrega en 48hrs en lugar de 3-5 d√≠as como diferenciador, (3) Reducir precios 10% en categor√≠as donde startup es m√°s fuerte para recuperar competitividad, (4) Lanzar programa de referidos con incentivos econ√≥micos para acelerar crecimiento de base de clientes, (5) Incrementar presupuesto de marketing digital 50% con foco en retargeting de clientes perdidos, (6) Crear bundles y promociones exclusivas online, (7) Mejorar customer service con chat en vivo, (8) Simplificar pol√≠ticas de devoluciones para igualar a startup. Ejecuci√≥n 6 meses.", cost: 185, impacts: {efficiency: 12, costs: -20, satisfaction: 18, sustainability: 5}, quality: "good", feedback: "Mejoras incrementales que cierran algunos gaps pero no transforman el modelo fundamentalmente. Depender de distribuidores tradicionales para velocidad es limitante estructural. Reducci√≥n de precios sin reducci√≥n de costos comprime m√°rgenes. No hay diferenciaci√≥n real vs atacar precio y promo que es insostenible long-term.", points: 20},
                    {text: "Enfoque defensivo de core business: (1) Fortalecer relaciones con distribuidores tradicionales con mejores t√©rminos comerciales y programas de incentivos por volumen, (2) Enfatizar en comunicaci√≥n la experiencia f√≠sica de compra y servicio personalizado en tienda vs frialdad digital, (3) Crear programa de lealtad para clientes actuales con descuentos exclusivos y eventos VIP, (4) Dirigir marketing a segmentos de mayor edad menos propensos a adopci√≥n digital, (5) Mantener precios premium justific√°ndolo con calidad y servicio, (6) Mejorar m√°rgenes con eficiencia operacional incremental y reducci√≥n de costos indirectos, (7) Diversificar portfolio hacia categor√≠as premium donde startup no compite, (8) Lobby con asociaciones de industria sobre regulaci√≥n de nuevos modelos. Consolidaci√≥n de fortalezas existentes.", cost: 180, impacts: {efficiency: 8, costs: -10, satisfaction: 8, sustainability: 3}, quality: "poor", feedback: "Estrategia de retirada que ignora realidad de mercado. Segmento millennial/Gen-Z es futuro de categor√≠a. Defender modelo legacy sin transformar es receta para declino gradual. Premium positioning sin innovaci√≥n real no es sustentable. Competencia seguir√° ganando share mientras se evita disruption necesaria.", points: 12}
                ]}
            ]
        };

        let gameState = {currentScenario: 0, efficiency: 65, costs: 450, satisfaction: 72, sustainability: 60, budget: 600, maxBudget: 600, score: 0};

        const finalCases = {
            easy: {
                title: "üíº Caso Final: Expansi√≥n Regional Estrat√©gica",
                context: "Tu empresa de manufactura quiere expandirse a Sudam√©rica. Actualmente operan exitosamente en Norteam√©rica con un sistema tradicional de gesti√≥n de inventarios y distribuci√≥n mediante partners locales. El mercado sudamericano muestra alta demanda proyectada para tus productos (crecimiento 15% anual), pero presenta desaf√≠os: infraestructura log√≠stica limitada en algunas zonas, competidores locales ya establecidos con ventaja de conocimiento del mercado, y regulaciones aduaneras complejas que var√≠an por pa√≠s. Tu junta directiva te pidi√≥ desarrollar la estrategia de entrada √≥ptima.",
                question: "¬øCu√°l es la MEJOR estrategia de expansi√≥n para Sudam√©rica aplicando principios de Supply Chain 4.0?",
                hasTimer: false,
                options: [
                    {text: "Estrategia de replicaci√≥n del modelo actual: establecer acuerdos con distribuidores locales tradicionales en cada pa√≠s objetivo, exportar producto terminado desde plantas norteamericanas utilizando rutas mar√≠timas establecidas, implementar el mismo sistema ERP que usas actualmente, contratar gerentes locales con experiencia en distribuci√≥n tradicional, y mantener control de calidad mediante visitas trimestrales de tu equipo.", points: 25, feedback: "Enfoque conservador que minimiza riesgo pero no aprovecha las capacidades de Supply Chain 4.0. Mantienes las mismas limitaciones operativas que tienes actualmente. La competencia local con modelos m√°s √°giles podr√≠a superarte r√°pidamente."},
                    {text: "Estrategia digital-first con tecnolog√≠a 4.0: implementar plataforma Cloud para visibilidad de inventario en tiempo real, usar IoT en todos los env√≠os para tracking preciso, aplicar algoritmos de IA para optimizar rutas considerando infraestructura limitada, establecer alianzas con centros log√≠sticos modernos en capitales principales, crear hub digital para coordinar operaciones con partners, usar analytics para entender patrones de demanda local, y programa de training digital para partners.", points: 50, feedback: "¬°Excelente! Estrategia que combina tecnolog√≠a Supply Chain 4.0 con comprensi√≥n de contexto local. La visibilidad en tiempo real y optimizaci√≥n con IA te permiten operar eficientemente incluso con infraestructura limitada. Modelo escalable y diferenciado vs competencia tradicional.", isCorrect: true},
                    {text: "Estrategia de inversi√≥n intensiva: construir mega-almacenes propios en las 3 ciudades principales de la regi√≥n con sistemas automatizados, usar exclusivamente transporte a√©reo para todas las entregas garantizando velocidad m√°xima, contratar equipo completo de operaciones en cada pa√≠s, implementar sistemas WMS de √∫ltima generaci√≥n en cada instalaci√≥n, y crear estructura organizacional completa en regi√≥n con equipos de ventas, marketing y operaciones locales.", points: 15, feedback: "Inversi√≥n muy alta que puede no ser justificable para entrada inicial a mercado nuevo. El transporte a√©reo exclusivo genera costos operativos insostenibles. Construir infraestructura pesada antes de validar demanda real es riesgoso. Modelo poco √°gil para adaptarse a aprendizajes de mercado."},
                    {text: "Estrategia e-commerce pura: enfocarse exclusivamente en ventas directas B2C a trav√©s de marketplace digital sin presencia f√≠sica ni inventarios locales, hacer env√≠os directos desde Norteam√©rica a consumidores finales conforme se generan pedidos, usar plataformas de pago y log√≠stica de terceros disponibles en cada pa√≠s, invertir fuertemente en marketing digital y redes sociales para crear demanda, y ofrecer precios competitivos al eliminar intermediarios de distribuci√≥n.", points: 20, feedback: "Enfoque moderno pero muy limitado. Los tiempos de entrega internacionales (10-15 d√≠as) no son competitivos. No considera desaf√≠os log√≠sticos regionales espec√≠ficos. Ignora el canal B2B que puede ser significativo. Falta presencia local para servicio post-venta y gestionar devoluciones eficientemente."}
                ]
            },
            normal: {
                title: "üíº Caso Final: Crisis Multifactorial de Suministro Global",
                context: "Eres Director de Supply Chain de una empresa manufactura de electr√≥nicos de consumo. Situaci√≥n cr√≠tica actual:\n\nüìä CONTEXTO:\n‚Ä¢ Tu principal proveedor de chips (representa 60% de tu suministro) suspendi√≥ entregas por 3 meses debido a incendio en su planta en Asia\n‚Ä¢ Tienes contratos firmados con clientes por $85M que debes cumplir en 8 semanas con penalizaci√≥n de $12M si incumples\n‚Ä¢ Competidores est√°n pagando hasta 300% de sobreprecio en mercado spot por chips, generando escasez artificial adicional\n‚Ä¢ Tu inventario actual de chips solo cubre 3 semanas de producci√≥n\n‚Ä¢ Presupuesto de emergencia aprobado: $8M\n‚Ä¢ Tu ventaja competitiva hist√≥rica: confiabilidad de entregas (98.5% on-time)\n‚Ä¢ Relaciones con clientes en juego: 3 son cuentas estrat√©gicas de largo plazo",
                question: "¬øCu√°l es la soluci√≥n m√°s ESTRAT√âGICA considerando corto y largo plazo, usando principios de Supply Chain 4.0?",
                hasTimer: false,
                options: [
                    {text: "Respuesta inmediata de mercado: utilizar $6M del presupuesto de emergencia para comprar chips disponibles en mercado spot al sobreprecio actual (aunque sea 300%), asegurar as√≠ el cumplimiento total de contratos actuales y proteger tu track record de confiabilidad de 98.5%, mantener relaciones con clientes estrat√©gicos, usar los $2M restantes en an√°lisis posterior para diversificar proveedores una vez que pase la crisis, y comunicar a junta directiva que priorizaste proteger reputaci√≥n y contratos sobre m√°rgenes.", points: 28, feedback: "Decisi√≥n que prioriza cumplimiento inmediato y reputaci√≥n, lo cual tiene l√≥gica financiera al evitar penalizaci√≥n de $12M. Sin embargo, es soluci√≥n puramente reactiva que no construye resiliencia futura. El sobreprecio reduce significativamente m√°rgenes. No aprovecha la crisis como oportunidad de transformaci√≥n. Competidores que inviertan en soluciones estructurales te superar√°n en siguiente ciclo."},
                    {text: "Transformaci√≥n estructural con enfoque 4.0: (1) Usar $2.5M para implementar plataforma Blockchain que certifique y diversifique proveedores tier-2 alternativos validados, (2) Invertir $2M en capacidad de Digital Twin para redise√±ar producto con chips alternativos disponibles sin perder funcionalidad cr√≠tica (acelera R&D de 6 meses a 4 semanas), (3) Aplicar $1.5M en IA para priorizar clientes estrat√©gicos y optimizar asignaci√≥n de inventario limitado, (4) Negociar extensi√≥n de 3 semanas con clientes no-estrat√©gicos ofreciendo compensaci√≥n de $800K, (5) Reservar $1.2M para alianzas de suministro de largo plazo con 2 proveedores secundarios, reduciendo dependencia de 60% a 35% del proveedor principal.", points: 60, feedback: "¬°Excelente! Soluci√≥n integral Supply Chain 4.0 que balancea corto y largo plazo. El Digital Twin acelera innovaci√≥n cr√≠tica, Blockchain crea red de suministro diversificada y transparente, IA optimiza decisiones complejas de asignaci√≥n. Aceptas impacto controlado en corto plazo ($800K en compensaciones + algunos clientes no-estrat√©gicos con delay) pero construyes resiliencia estructural. ROI de la transformaci√≥n tecnol√≥gica se recupera en 14 meses y reduce riesgo sist√©mico para futuro.", isCorrect: true},
                    {text: "Estrategia de negociaci√≥n y contingencia: cancelar proactivamente contratos con clientes no-estrat√©gicos (aproximadamente 40% del total) pagando penalizaciones negociadas de $4M, usar $3M para comprar chips en mercado spot suficiente para cumplir al 100% con los 3 clientes estrat√©gicos clave, destinar $1M a desarrollar relaci√≥n acelerada con proveedor alternativo en Europa que puede iniciar suministro en 6 semanas (aunque a precio 60% m√°s alto que proveedor original), comunicar estrategia a stakeholders enfatizando protecci√≥n de clientes m√°s importantes y construcci√≥n de diversificaci√≥n geogr√°fica.", points: 32, feedback: "Estrategia pragm√°tica que prioriza cuentas clave y comienza diversificaci√≥n. El sacrificio de clientes no-estrat√©gicos es doloroso pero calculado. Proveedor europeo ayuda pero 60% de sobreprecio permanente afecta competitividad. No hay transformaci√≥n tecnol√≥gica real. Soluci√≥n h√≠brida que resuelve inmediatez pero no construye ventajas de Supply Chain 4.0. Competidores con mejor tecnolog√≠a te superar√°n en siguiente fase."},
                    {text: "Postura de transparencia y espera estrat√©gica: comunicar inmediatamente y con total transparencia la situaci√≥n a todos los clientes explicando causa de fuerza mayor, ofrecer aceptar todas las penalizaciones contractuales ($12M) pero comprometi√©ndote a cumplir en 12 semanas cuando proveedor principal reanude operaciones, usar los $8M de presupuesto exclusivamente en optimizar relaci√≥n con proveedor principal (enviar equipo t√©cnico a apoyar su recuperaci√≥n, ofrecer adelantos financieros, comprometer vol√∫menes futuros incrementados), no comprar en mercado spot para no alimentar especulaci√≥n, y apostar a que tu transparencia y √©tica de negocio fortalecer√° relaciones de largo plazo con clientes que valorar√°n tu honestidad.", points: 18, feedback: "Enfoque √©tico admirable pero financieramente riesgoso. Aceptar $12M en penalizaciones cuando existe presupuesto de emergencia es dif√≠cil de justificar ante junta directiva y accionistas. Algunos clientes apreciar√°n transparencia pero otros simplemente cambiar√°n de proveedor. No hay inversi√≥n en transformaci√≥n tecnol√≥gica ni diversificaci√≥n. Apoyar al proveedor en crisis es correcto pero no elimina dependencia estructural. Soluci√≥n que prioriza valores sobre resultados, lo cual puede no ser sostenible en entorno competitivo."}
                ]
            },
            hard: {
                title: "üíº Caso Final Experto: Transformaci√≥n Integral Supply Chain 4.0",
                context: "Eres VP de Supply Chain & Operations de MegaCorp Manufacturing, empresa con 60 a√±os de historia. Situaci√≥n cr√≠tica actual:\n\nüìä PERFIL FINANCIERO:\n‚Ä¢ Ingresos anuales: $850M\n‚Ä¢ Costos operacionales supply chain: $425M (50% de ingresos) - benchmark industria: 38%\n‚Ä¢ EBITDA margin: 12% (vs 18% de l√≠deres del sector)\n‚Ä¢ D√≠as de inventario: 95 d√≠as ($180M inmovilizado, 35% es stock obsoleto o slow-moving)\n‚Ä¢ Cash conversion cycle: 78 d√≠as (competencia l√≠der: 42 d√≠as)\n\n‚öôÔ∏è OPERACIONES:\n‚Ä¢ 8 plantas de manufactura en 5 pa√≠ses (utilizaci√≥n promedio: 62%)\n‚Ä¢ 22 centros de distribuci√≥n (redundancias significativas)\n‚Ä¢ 280 proveedores en 35 pa√≠ses (visibilidad de supply <25%)\n‚Ä¢ Satisfacci√≥n del cliente: 71% (benchmark: 87%)\n‚Ä¢ Time-to-market nuevos productos: 14 meses (competencia: 6 meses)\n‚Ä¢ Perfect order rate: 78% (target industria: 92%)\n\nüíª TECNOLOG√çA:\n‚Ä¢ ERP: SAP R/3 implementado en 2003, sin actualizaci√≥n mayor\n‚Ä¢ Comunicaci√≥n con proveedores: 40% email, 35% tel√©fono, 25% EDI b√°sico\n‚Ä¢ Demand planning: Excel con macros, forecasting manual\n‚Ä¢ No hay IoT, no hay AI/ML, no hay analytics avanzado, no hay automatizaci√≥n de almacenes\n‚Ä¢ Data quality issues: 4 sistemas legados sin integrar, m√∫ltiples masters de datos\n\nüéØ PRESI√ìN COMPETITIVA:\n‚Ä¢ 3 startups en tu industria con Supply Chain 4.0 nativo han capturado 22% market share en 3 a√±os\n‚Ä¢ Ofrecen: entregas 60% m√°s r√°pidas, personalizaci√≥n masiva, precio 18% menor, modelo D2C sin intermediarios\n‚Ä¢ Tu modelo: distribuci√≥n tradicional multi-tier, producto est√°ndar, ciclos largos\n\nüë• ORGANIZACI√ìN:\n‚Ä¢ 1,200 empleados en supply chain (promedio edad: 48 a√±os)\n‚Ä¢ 55% del staff sin formaci√≥n digital formal\n‚Ä¢ Estructura jer√°rquica tradicional de 6 niveles\n‚Ä¢ Silos entre departamentos (procurement, manufacturing, logistics, planning operan independientemente)\n‚Ä¢ Resistencia cultural documentada al cambio (√∫ltimo intento de transformaci√≥n fall√≥ en 2019)\n\nüí∞ APROBACI√ìN DE JUNTA:\n‚Ä¢ Budget de transformaci√≥n: $65M en 24 meses\n‚Ä¢ KPIs exigidos para mes 24: reducir costos a 40% de ingresos, mejorar satisfacci√≥n a 85%, reducir time-to-market a 7 meses, aumentar EBITDA a 16%\n‚Ä¢ Restricciones: no puedes parar operaciones, no puedes cerrar m√°s de 2 plantas, debes mantener servicio a clientes actuales, compliance con regulaciones de datos (GDPR, CCPA), sindicato se opone a automatizaci√≥n que elimine empleos directamente\n\n‚ö†Ô∏è RIESGOS:\n‚Ä¢ 2 competidores tradicionales tambi√©n est√°n transformando (tienes ventana de 18 meses)\n‚Ä¢ 40% de tu management team amenaza con salir si hay cambios muy disruptivos\n‚Ä¢ Principal cliente (22% de ingresos) est√° evaluando re-sourcing y exige mejoras en 12 meses\n‚Ä¢ Valuaci√≥n de empresa ha ca√≠do 35% en 2 a√±os por underperformance vs sector",
                question: "Dise√±a la ESTRATEGIA √ìPTIMA de transformaci√≥n a Supply Chain 4.0. Tu estrategia debe abordar: (1) tecnolog√≠a y datos, (2) procesos y operaciones, (3) organizaci√≥n y talento, (4) modelo de negocio, (5) gesti√≥n de riesgos, (6) roadmap de implementaci√≥n con quick wins, (7) ROI y business case financiero. Selecciona el approach m√°s comprehensivo y balanceado:",
                hasTimer: false,
                options: [
                    {text: "ESTRATEGIA A - Big Bang Technology Push:\n\nINVERSI√ìN TECNOL√ìGICA MASIVA ($52M): Reemplazar completamente stack tecnol√≥gico con plataforma unificada cloud-native (ERP S/4HANA, TMS, WMS, MES de tier-1 vendors). Implementar IoT en 100% de assets con 5G connectivity. Desplegar IA/ML platform con 12 use cases simult√°neos (demand forecasting, inventory optimization, predictive maintenance, quality control, routing, pricing). Blockchain para toda la red de suppliers. Robots AMR en 6 DCs principales. Digital Twin de operaci√≥n completa.\n\nPROCESOS ($8M): Redise√±o radical BPR de todos los procesos core con metodolog√≠a SAFe Agile. Eliminar 45% de handoffs actuales. Implementar S&OP integrado mensual. Control Tower 24/7 con 8 analistas especializados.\n\nORGANIZACI√ìN ($5M): Restructuraci√≥n completa a modelo matricial por competencias. Crear rol de Chief Digital Officer reportando a CEO. Hiring externo de 40 especialistas digitales (data scientists, solution architects, DevOps). Early retirement package para 15% del staff senior m√°s resistente.\n\nIMPLEMENTACI√ìN: Simult√°nea en 12 meses con go-live √∫nico en todas las geograf√≠as. Big bang cutover en fin de semana largo. War room de 60 personas durante transici√≥n.", points: 32, feedback: "Approach tecnol√≥gicamente ambicioso que busca salto cu√°ntico, pero presenta riesgos cr√≠ticos de ejecuci√≥n. Big bang en Supply Chain es notoriamente propenso al fracaso (68% de proyectos ERP fallan seg√∫n Panorama Consulting). No puedes parar operaciones seg√∫n restricci√≥n, pero implementaci√≥n simult√°nea en 12 meses virtualmente garantiza disrupciones operativas severas que afectar√°n servicio al cliente justo cuando cliente principal est√° evaluando re-sourcing. Restructuraci√≥n organizacional masiva con salida de 15% de management genera p√©rdida de conocimiento institucional cr√≠tico. No hay quick wins tempranos para generar momentum y buy-in. Culturalmente traum√°tico: combinas cambio tecnol√≥gico, de procesos y organizacional simult√°neamente sin tiempo de adaptaci√≥n. ROI te√≥rico de 28 meses pero probabilidad de alcanzarlo <40%. Subestimas importancia de gesti√≥n de cambio y adopci√≥n de usuarios. En balance: strategy demasiado arriesgada para contexto de empresa con cultura tradicional y restricciones operativas."},
                    {text: "ESTRATEGIA B - Transformaci√≥n Secuencial Inteligente:\n\nFASE 1 (Meses 1-8, $18M) - QUICK WINS + FUNDAMENTOS: Implementar Control Tower cloud con integraciones API ligeras a sistemas existentes (no reemplazas ERP a√∫n). IoT en top 30% de assets cr√≠ticos usando 80/20 rule. IA para demand forecasting en top 200 SKUs (70% de revenue). Automatizaci√≥n RPA de procesos administrativos (O2C, P2P, planning). Dashboard ejecutivo en tiempo real. Consolidar 4 DCs redundantes a 2 DCs modernizados con WMS cloud y automation parcial. Cerrar 1 planta de menor eficiencia redistribuyendo volumen. Metrics: reducir costos 5%, mejorar servicio 8pp, liberar $35M de inventario. MOSTRAR RESULTADOS TEMPRANOS TANGIBLES.\n\nFASE 2 (Meses 9-16, $28M) - EXPANSI√ìN Y PROFUNDIZACI√ìN: Upgrade ERP a S/4HANA con metodolog√≠a brownfield (mantiene configuraciones validadas, migraci√≥n por m√≥dulos). Extender IoT a 80% de assets. Ampliar IA/ML a 15 use cases incluyendo prescriptive analytics. Blockchain para top 50 suppliers cr√≠ticos. Digital Twins de 3 plantas m√°s complejas. Redise√±o de procesos S&OP a IBP con planificaci√≥n integrada. Implementar capability centers con especialistas (analytics, automation, digital supply chain). Programa formal de change management con 50 champions internos. Upskilling de 400 empleados en competencias digitales (sin despidos, reconversi√≥n). Metrics: costos a 42%, satisfacci√≥n a 80%, time-to-market a 9 meses.\n\nFASE 3 (Meses 17-24, $19M) - OPTIMIZACI√ìN Y MODELO DE NEGOCIO: Completar transformaci√≥n tecnol√≥gica (100% IoT, AI/ML en todas funciones). Automatizaci√≥n avanzada en 4 DCs restantes con cobots (colaborativos, no reemplazan personas). Marketplace digital para conectar con customers directamente (modelo h√≠brido B2B2C). Plataforma de collaboration con suppliers tier-2 y tier-3. Sustainability metrics integrados (Scope 1,2,3). Control Tower cognitivo con capacidades de self-healing. Estructura organizacional agile con squads multifuncionales. KPI dashboards para todos los niveles. Metrics: costos a 39%, satisfacci√≥n a 86%, time-to-market a 6.5 meses, EBITDA a 16.5%.\n\nGOBERNANZA: Steering committee mensual con CEO. Program Office dedicado de 12 personas. Metodolog√≠a agile con sprints de 3 semanas. Stage-gates para aprobar paso a siguiente fase (no autom√°tico). Gesti√≥n de riesgos proactiva con 45 riesgos identificados y planes de mitigaci√≥n. Investment tranches: liberas siguiente fase solo si anterior cumple 80% de KPIs. Communication plan robusto: townhalls mensuales, newsletters, success stories. Pilotos antes de escalar (ej: IoT en 1 planta antes de 8). Retenci√≥n de talento cr√≠tico con incentivos. Compliance por dise√±o (GDPR, CCPA). Post-implementation support de 6 meses.", points: 95, feedback: "üåü ESTRATEGIA √ìPTIMA - Este approach representa best practice en transformaci√≥n digital de Supply Chain. Razones clave: (1) GESTI√ìN DE RIESGO: Faseamiento permite aprender y ajustar, reduce riesgo de big-bang catastrophic failure. Stage gates aseguran que cada fase entrega valor antes de continuar invirtiendo. (2) QUICK WINS: Fase 1 demuestra ROI temprano (mes 8) generando credibilidad y momentum cr√≠ticos para sostener transformaci√≥n larga. $35M liberados de inventario ayudan a autofinanciar siguientes fases. (3) PEOPLE-CENTRIC: Upskilling en lugar de layoffs es √©ticamente correcto y pr√°cticamente inteligente - necesitas el conocimiento de negocio del staff actual. Champions y change management formal son diferenciadores vs proyectos que fallan. (4) TECNOLOG√çA PRAGM√ÅTICA: No boils the ocean - empieza con quick wins (RPA, dashboards) antes de ERP heavy lifting. Brownfield SAP migration es m√°s segura que greenfield. 80/20 rule en IoT maximiza ROI. (5) CONTINUIDAD OPERATIVA: Implementaci√≥n modular minimiza disrupciones. Pilotos antes de scale evitan sorpresas. Mantienes servicio a clientes durante transformaci√≥n. (6) BALANCE DE PRIORIDADES: Aborda technology, processes, organization y business model secuencialmente. No overwhelms la organizaci√≥n con cambios simult√°neos. (7) FINANCIERO S√ìLIDO: Alcanza KPIs de junta (costos 39%, satisfacci√≥n 86%, time-to-market 6.5 meses, EBITDA 16.5%). ROI acumulado de 240% en 36 meses. NPV del proyecto: $125M. Payback en mes 22. (8) VENTAJA COMPETITIVA: Resultados de fase 1-2 te posicionan para competir con startups. Fase 3 te diferencia con capabilities √∫nicos. En s√≠ntesis: estrategia comprehensiva, balanceada, de-risked y ejecutable que tiene alta probabilidad de √©xito (70%) en contexto de empresa tradicional con restricciones y cultura challenging.", isCorrect: true},
                    {text: "ESTRATEGIA C - Optimization Incrementalista:\n\nTECNOLOG√çA ($32M): Actualizar ERP actual (SAP R/3 a ECC 6.0, no S/4HANA a√∫n para minimizar disrupci√≥n). Implementar mejor pr√°ctica de WMS en los 4 DCs m√°s grandes. Sistema de TMS para optimizar transporte. Dashboards de BI con Tableau/PowerBI conectado a ERP v√≠a extracts nocturnos. Implementar EDI con top 80 suppliers para reducir email/tel√©fono. IoT pilot en 1 planta para validar tecnolog√≠a. Exploration de IA con 2 use cases proof-of-concept (demand forecast y inventory optimization) sin deployment a producci√≥n a√∫n.\n\nPROCESOS ($15M): Contratar consultora tier-2 para redise√±o de procesos cr√≠ticos (S&OP, O2C, P2P) siguiendo frameworks est√°ndar de industria. Implementar mejoras con enfoque Lean Six Sigma. Crear Center of Excellence de planning con 8 planners senior. Mejorar SLAs con proveedores mediante negociaci√≥n y scorecards. Estandarizar procesos entre plantas (actualmente cada planta opera diferente).\n\nORGANIZACI√ìN ($12M): Formaci√≥n de management team en principios de Supply Chain 4.0 (sin cambios estructurales profundos). Hiring selectivo de 15 especialistas para roles cr√≠ticos (supply chain analytics, digital project managers). Crear comit√© de transformaci√≥n digital que se re√∫ne mensualmente. Programa de embajadores digitales voluntarios (20 personas). Mantener estructura organizacional actual (evita resistencia de management).\n\nINFRAESTRUCTURA ($6M): Consolidar 3 DCs de menor volumen. Actualizar equipos de handling en almacenes principales. Mejorar connectivity de IT en plantas (bandwidth, WiFi). Cybersecurity b√°sico (firewalls, antivirus, backups).\n\nIMPLEMENTACI√ìN: Incremental en 24 meses sin deadlines agresivos. Cada proyecto se implementa cuando est√° 100% ready. Enfoque en \"hacer bien lo b√°sico\" antes de tecnolog√≠as avanzadas. Change management light (comunicados, algunas training sessions).", points: 48, feedback: "Strategy conservadora que prioriza minimizaci√≥n de riesgo sobre transformaci√≥n real. Puntos positivos: es ejecutable con baja probabilidad de falla catastr√≥fica, mantiene operaciones estables, no disrumpe organizaci√≥n. Sin embargo, presenta limitaciones cr√≠ticas: (1) NO ALCANZA OBJETIVOS: Con este approach incremental es muy improbable que alcances los KPIs agresivos que junta demand√≥ (costos 40%, satisfacci√≥n 85%, time-to-market 7 meses, EBITDA 16%). Proyecciones realistas: costos 46%, satisfacci√≥n 77%, time-to-market 11 meses, EBITDA 13.5% - insuficiente. (2) VENTANA COMPETITIVA: Los 2 competidores tradicionales que est√°n transformando te superar√°n. Startups continuar√°n ganando share. En 24 meses estar√°s en peor posici√≥n relativa. (3) NO ES SUPPLY CHAIN 4.0: Actualizar ERP viejo a versi√≥n menos vieja no es transformaci√≥n digital. PoCs de IA sin deployment no generan valor. IoT pilot en 1 planta es testimonial. No hay automation real ni ML en producci√≥n. (4) TALENTO: Hiring de solo 15 especialistas es insuficiente para escala de transformaci√≥n necesaria. Sin upskilling masivo, la workforce no desarrolla capabilities digitales. (5) PROCESO: Lean Six Sigma es valioso pero es metodolog√≠a de los 90s. No reinventa procesos para era digital. (6) ROI LIMITADO: Mejoras incrementales generan ROI marginal (~8% reducci√≥n de costos) insuficiente vs inversi√≥n de $65M. NPV probablemente negativo. En resumen: strategy \"safe\" que no resuelve el problema fundamental - necesitas transformaci√≥n radical, no optimizaci√≥n incremental. Cliente principal que representa 22% de revenue probablemente se ir√° al no ver mejoras sustanciales en 12 meses. Junta rechazar√° continuar financiando al ver underperformance vs targets en mes 12. Approach appropriate para empresa con tiempo, pero tu contexto requiere velocidad y ambici√≥n mayor."},
                    {text: "ESTRATEGIA D - Pivot to Asset-Light Platform Model:\n\nTRANSFORMACI√ìN DE MODELO DE NEGOCIO ($28M): Decisi√≥n estrat√©gica radical - no optimizas supply chain tradicional, lo reemplazas con modelo de platform orchestrator. Vendes 5 de 8 plantas a contract manufacturers especializados (generates $140M en cash, net de costos de transacci√≥n). Mantienes 3 plantas core para productos m√°s estrat√©gicos y capabilities √∫nicas. Cierras 14 de 22 DCs, subcontratas fulfillment a 3PLs especializados (Amazon Logistics, DHL Supply Chain, XPO) que ya tienen tecnolog√≠a 4.0 y footprint optimizado. Reduces base de empleados de supply chain de 1,200 a 450 (enfocados en orchestration, analytics, innovation, no en ejecuci√≥n). Transforms de asset-heavy manufacturer a asset-light orchestrator.\n\nPLATAFORMA DIGITAL ($22M): Construyes platform technology stack que conecta suppliers, contract manufacturers, 3PLs, y customers en ecosistema digital. Control Tower avanzado con IA que optimiza toda la network en tiempo real (no eres due√±o de assets pero controlas flows). APIs para integraci√≥n con todos los partners. Blockchain para contratos inteligentes y pagos autom√°ticos. Marketplace B2B donde customers configuran productos y ven delivery dates en tiempo real. Data lake que agrega informaci√≥n de todos los nodos de la network para insights.\n\nCAPABILITIES CORE ($10M): Inviertes en lo que te diferencia: (1) Product innovation con digital twins y simulation, (2) Customer experience y CRM digital de √∫ltima generaci√≥n, (3) Data analytics y AI/ML con equipo de 40 data scientists, (4) Sustainability leadership con tracking completo de huella de carbono end-to-end, (5) Network design y optimization, (6) Quality assurance sin ownership de assets. Hiring agresivo de talento digital (100 personas), offboarding de 750 empleados operativos con packages de 1.5 a√±os de salario.\n\nEJECUCI√ìN ($5M): Transformaci√≥n en 18 meses con 3 waves de 6 meses. Wave 1: venta de 2 plantas, cierre de 6 DCs, contracts con 3PLs, layoff de 300. Wave 2: venta de 3 plantas adicionales, cierre de 8 DCs m√°s, platform beta launch. Wave 3: consolidaci√≥n final, platform production launch, full transition a modelo asset-light. M&A advisor para asset sales. Change management enfocado en nueva value proposition (\"no fabricamos, orquestamos\").", points: 35, feedback: "Pivot estrat√©gico audaz y disruptivo que reconceptualiza fundamentalmente el negocio. Inspirado en casos de Nike, Apple o Zara que orquestan networks globales sin ownership de manufacturing. Aspectos positivos: (1) FINANCIERO ATRACTIVO: Venta de assets genera $140M cash que m√°s que cubre los $65M de inversi√≥n en transformaci√≥n y fondea crecimiento futuro. Reduces OPEX masivamente (no tienes costos fijos de plantas/DCs). Potentially alcanzas EBITDA >20% con modelo asset-light. (2) VELOCIDAD: 18 meses es m√°s r√°pido que modernizar 8 plantas y 22 DCs. (3) FOCO: Liberas organizaci√≥n de complejidades operativas para enfocarte en innovation, customer experience y orchestration. (4) FLEXIBILIDAD: Asset-light permite escalar up/down seg√∫n demanda sin capital investments. Sin embargo, presenta riesgos y limitaciones CR√çTICAS: (1) CONTROL: Pierdes control directo de manufacturing quality y delivery - ahora dependes de contract manufacturers y 3PLs. Si ellos fallan, tu marca sufre. (2) CAPACIDADES: Al vender plantas pierdes conocimiento t√©cnico de manufacturing que has desarrollado en 60 a√±os. Dif√≠cil de recuperar si modelo falla. (3) IMPLEMENTACI√ìN: 750 layoffs es masivo y traum√°tico - implicaciones legales, morales, de reputaci√≥n. Sindicato probablemente litigar√°. (4) CLIENTE: Principal cliente que exige mejoras en 12 meses puede no querer trabajar con orchestrator, prefiere manufacturer con control de assets. (5) RESTRICCIONES: Junta dijo \"no puedes cerrar m√°s de 2 plantas\" pero esta strategy cierra/vende 5. Potentially no est√° autorizada. (6) COMPETITIVO: Competitors pueden usar tu salida de manufacturing para capturar customers que valoran vertical integration. (7) TIMING: Ejecutar venta de assets + transformation digital + massive workforce reduction simult√°neamente en 18 meses mientras mantienes servicio es casi imposible. En balance: strategy tiene l√≥gica para startup o para company con different context, pero para manufacturer de 60 a√±os con cultura tradicional es demasiado radical y risky. No es evoluci√≥n, es revoluci√≥n - probabilidad de √©xito <30% en tu contexto espec√≠fico."}
                ]
            }
        };

        let gameState = {currentScenario: 0, efficiency: 65, costs: 450, satisfaction: 72, sustainability: 60, budget: 600, maxBudget: 600, score: 0, difficulty: 'normal'};

        function initApp() {
            try {
                if (typeof firebase === 'undefined') {
                    document.getElementById('loading-screen').innerHTML = '<h2 style="color: red;">‚ùå Error: Firebase no carg√≥</h2>';
                    return;
                }
                firebase.initializeApp({
                    apiKey: "AIzaSyDIUt20W8U7cUDqyfLYxqrs2-pNwTodvi4",
                    authDomain: "supply-chain-game-f1bc4.firebaseapp.com",
                    databaseURL: "https://supply-chain-game-f1bc4-default-rtdb.firebaseio.com",
                    projectId: "supply-chain-game-f1bc4",
                    storageBucket: "supply-chain-game-f1bc4.firebasestorage.app",
                    messagingSenderId: "992566402291",
                    appId: "1:992566402291:web:3a699f86b04cca816eab86"
                });
                db = firebase.database();
                document.getElementById('loading-screen').style.display = 'none';
                document.getElementById('entry-screen').classList.add('active');
            } catch (e) {
                document.getElementById('loading-screen').innerHTML = '<h2 style="color: red;">‚ùå Error: ' + e.message + '</h2>';
            }
        }

        window.addEventListener('load', () => setTimeout(initApp, 500));

        function showCreateRoom() { document.getElementById('create-room-form').style.display = 'block'; document.getElementById('join-room-form').style.display = 'none'; }
        function showJoinRoom() { document.getElementById('join-room-form').style.display = 'block'; document.getElementById('create-room-form').style.display = 'none'; }

        function createRoom() {
            const roomName = document.getElementById('room-name-input').value.trim();
            const hostName = document.getElementById('host-name-input').value.trim();
            if (!roomName || !hostName) { alert('Completa campos'); return; }
            const roomCode = generateRoomCode();
            currentPlayer = {name: hostName, id: generateId()};
            currentRoom = {code: roomCode, name: roomName, host: currentPlayer.id, players: {}, teams: {}, votes: {}, difficulty: null, status: 'lobby', createdAt: Date.now()};
            currentRoom.players[currentPlayer.id] = currentPlayer;
            db.ref('rooms/' + roomCode).set(currentRoom).then(() => { listenToRoom(roomCode); showLobby(); }).catch(err => alert('Error: ' + err.message));
        }

        function joinRoom() {
            const roomCode = document.getElementById('room-code-input').value.trim().toUpperCase();
            const playerName = document.getElementById('player-name-input').value.trim();
            if (!roomCode || !playerName) { alert('Completa campos'); return; }
            currentPlayer = {name: playerName, id: generateId()};
            db.ref('rooms/' + roomCode).once('value').then(snapshot => {
                if (snapshot.exists()) {
                    currentRoom = snapshot.val();
                    db.ref('rooms/' + roomCode + '/players/' + currentPlayer.id).set(currentPlayer).then(() => { listenToRoom(roomCode); showLobby(); });
                } else alert('C√≥digo no existe');
            }).catch(err => alert('Error: ' + err.message));
        }

        function createTeam() {
            const teamName = document.getElementById('team-name-input').value.trim();
            if (!teamName) { alert('Nombre equipo'); return; }
            const teamId = generateId();
            currentTeam = {id: teamId, name: teamName, members: [currentPlayer.id], status: 'waiting', score: 0, timeBonus: 0, createdAt: Date.now()};
            db.ref('rooms/' + currentRoom.code + '/teams/' + teamId).set(currentTeam).then(() => {
                document.getElementById('pre-team-section').style.display = 'none';
                document.getElementById('team-formed-section').style.display = 'block';
            });
        }

        function joinTeam(teamId) {
            const team = currentRoom.teams[teamId];
            if (team && !team.members.includes(currentPlayer.id)) {
                team.members.push(currentPlayer.id);
                currentTeam = team;
                db.ref('rooms/' + currentRoom.code + '/teams/' + teamId + '/members').set(team.members).then(() => {
                    document.getElementById('pre-team-section').style.display = 'none';
                    document.getElementById('team-formed-section').style.display = 'block';
                });
            }
        }

        function vote(difficulty) {
            if (!currentTeam) return;
            db.ref('rooms/' + currentRoom.code + '/votes/' + currentTeam.id).set(difficulty);
            updateMyVoteDisplay(difficulty);
        }

        function updateMyVoteDisplay(difficulty) {
            const displayDiv = document.getElementById('my-vote-display');
            const textSpan = document.getElementById('my-vote-text');
            const labels = {easy: 'üòä Principiante', normal: 'üéØ Normal', hard: 'üî• Experto'};
            textSpan.textContent = labels[difficulty];
            displayDiv.style.display = 'block';
        }

        function startMultiplayerGame() {
            const difficulties = {easy: {budget: 800, time: 30}, normal: {budget: 600, time: 25}, hard: {budget: 400, time: 20}};
            const config = difficulties[currentRoom.difficulty];
            gameState.budget = config.budget;
            gameState.maxBudget = config.budget;
            gameState.difficulty = currentRoom.difficulty;
            timeLimit = config.time;
            totalTimeBonus = 0;
            db.ref('rooms/' + currentRoom.code + '/teams/' + currentTeam.id + '/status').set('playing');
            showGame();
        }

        function startTimer() {
            timeRemaining = timeLimit;
            updateTimerDisplay();
            if (timerInterval) clearInterval(timerInterval);
            timerInterval = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                if (timeRemaining <= 0) {
                    clearInterval(timerInterval);
                    handleTimeout();
                }
            }, 1000);
        }

        function stopTimer() {
            if (timerInterval) {
                clearInterval(timerInterval);
                timerInterval = null;
            }
        }

        function updateTimerDisplay() {
            const timerEl = document.getElementById('timer');
            timerEl.textContent = timeRemaining + 's';
            timerEl.className = 'timer';
            if (timeRemaining <= 5) timerEl.classList.add('danger');
            else if (timeRemaining <= 10) timerEl.classList.add('warning');
        }

        function handleTimeout() {
            document.querySelectorAll('.option-btn').forEach(btn => btn.disabled = true);
            const feedbackDiv = document.getElementById('feedback');
            feedbackDiv.className = 'feedback show poor';
            feedbackDiv.innerHTML = '<strong>‚è∞ ¬°Tiempo agotado!</strong><p>No obtuviste puntos por esta decisi√≥n</p>';
            setTimeout(() => {
                feedbackDiv.innerHTML += '<button class="btn" onclick="nextScenario()">Continuar ‚û°Ô∏è</button>';
            }, 2000);
        }

        function selectOption(scenarioIndex, optionIndex) {
            const currentScenarios = scenariosByDifficulty[gameState.difficulty] || scenariosByDifficulty.normal;
            const scenario = currentScenarios[scenarioIndex];
            const option = scenario.options[optionIndex];
            if (option.cost > gameState.budget) return;
            
            stopTimer();
            const timeBonus = Math.max(0, timeRemaining);
            totalTimeBonus += timeBonus;
            
            document.querySelectorAll('.option-btn').forEach(btn => btn.disabled = true);
            gameState.budget -= option.cost;
            Object.keys(option.impacts).forEach(key => gameState[key] += option.impacts[key]);
            gameState.score += option.points + timeBonus;
            updateStats();
            
            const feedbackDiv = document.getElementById('feedback');
            feedbackDiv.className = 'feedback show ' + option.quality;
            feedbackDiv.innerHTML = `<strong>${option.quality === 'best' ? 'üåü ¬°Excelente!' : option.quality === 'good' ? '‚úÖ Buena' : '‚ö†Ô∏è Sub√≥ptima'}</strong><p>${option.feedback}</p><p><strong>Puntos:</strong> +${option.points}</p><p style="color: #4caf50;"><strong>‚è±Ô∏è Bonus tiempo:</strong> +${timeBonus}</p>`;
            setTimeout(() => feedbackDiv.innerHTML += `<button class="btn" onclick="nextScenario()">${scenarioIndex < currentScenarios.length - 1 ? 'Siguiente ‚û°Ô∏è' : 'Caso Final üéØ'}</button>`, 1500);
        }

        function nextScenario() {
            const currentScenarios = scenariosByDifficulty[gameState.difficulty] || scenariosByDifficulty.normal;
            if (gameState.currentScenario < currentScenarios.length - 1) {
                loadScenario(gameState.currentScenario + 1);
            } else {
                loadFinalCase();
            }
        }

        function loadFinalCase() {
            const difficulty = gameState.difficulty || 'normal';
            const finalCase = finalCases[difficulty];
            gameState.currentScenario++;
            
            let html = `
                <div class="scenario">
                    <h3>${finalCase.title}</h3>
                    <div class="scenario-context">
                        <strong>üìã CONTEXTO COMPLETO:</strong>
                        <p style="white-space: pre-line; margin-top: 10px;">${finalCase.context}</p>
                    </div>
                    <p style="font-weight: bold; font-size: 1.1em; margin-top: 15px;">${finalCase.question}</p>
                    <div class="info-box" style="background: #fff3e0; border-left-color: #ff9800;">
                        <p style="color: #e65100; font-weight: bold;">‚è±Ô∏è SIN L√çMITE DE TIEMPO - Analiza con calma y elige sabiamente</p>
                    </div>
                    <div class="options">
            `;
            
            finalCase.options.forEach((option, i) => {
                html += `<button class="option-btn" onclick="selectFinalOption(${i})" style="white-space: pre-line; text-align: left; padding: 20px;">${option.text}</button>`;
            });
            
            html += `</div><div id="feedback" class="feedback"></div></div>`;
            document.getElementById('scenario-container').innerHTML = html;
            
            // NO iniciar temporizador para caso final
            stopTimer();
            document.getElementById('timer').textContent = '‚àû';
            document.getElementById('timer').className = 'timer';
        }

        function selectFinalOption(optionIndex) {
            const difficulty = gameState.difficulty || 'normal';
            const finalCase = finalCases[difficulty];
            const option = finalCase.options[optionIndex];
            
            // No hay bonus de tiempo en caso final
            stopTimer();
            
            document.querySelectorAll('.option-btn').forEach(btn => btn.disabled = true);
            gameState.score += option.points;
            updateStats();
            
            const feedbackDiv = document.getElementById('feedback');
            feedbackDiv.className = 'feedback show ' + (option.isCorrect ? 'best' : 'poor');
            feedbackDiv.innerHTML = `<strong>${option.isCorrect ? 'üéØ ¬°CORRECTO!' : '‚ùå No es la mejor opci√≥n'}</strong><p>${option.feedback}</p><p><strong>Puntos:</strong> +${option.points}</p>`;
            setTimeout(() => {
                feedbackDiv.innerHTML += '<button class="btn" onclick="endGame()">Ver Resultados üèÜ</button>';
            }, 2000);
        }

        function backToLobby() { document.getElementById('results-screen').classList.remove('active'); document.getElementById('lobby-screen').classList.add('active'); updateLobby(); }

        function listenToRoom(roomCode) {
            roomListener = db.ref('rooms/' + roomCode).on('value', snapshot => {
                if (snapshot.exists()) { currentRoom = snapshot.val(); updateLobby(); checkIfAllVoted(); }
            });
        }

        function checkIfAllVoted() {
            if (!currentRoom || !currentRoom.teams) return;
            const allTeams = Object.values(currentRoom.teams);
            if (allTeams.length === 0) return;
            const allVoted = allTeams.every(team => currentRoom.votes && currentRoom.votes[team.id]);
            if (allVoted && !currentRoom.difficulty) {
                const voteCounts = {easy: 0, normal: 0, hard: 0};
                Object.values(currentRoom.votes).forEach(vote => voteCounts[vote]++);
                let winningDifficulty = 'normal', maxVotes = 0;
                Object.entries(voteCounts).forEach(([diff, count]) => { if (count > maxVotes) { maxVotes = count; winningDifficulty = diff; }});
                db.ref('rooms/' + currentRoom.code + '/difficulty').set(winningDifficulty);
            }
            if (currentRoom.difficulty && currentTeam) {
                document.getElementById('waiting-message').style.display = 'none';
                document.getElementById('start-game-btn').style.display = 'block';
            }
        }

        function showLobby() {
            document.getElementById('entry-screen').classList.remove('active');
            document.getElementById('lobby-screen').classList.add('active');
            document.getElementById('lobby-room-name').textContent = currentRoom.name;
            document.getElementById('room-code-display').textContent = currentRoom.code;
            updateLobby();
        }

        function updateLobby() {
            if (!currentRoom) return;
            const playersWithoutTeam = Object.values(currentRoom.players || {}).filter(player => !Object.values(currentRoom.teams || {}).some(team => team.members && team.members.includes(player.id)));
            let playersHTML = '';
            playersWithoutTeam.forEach(player => playersHTML += `<span class="player-chip">${player.name}</span>`);
            document.getElementById('players-waiting-list').innerHTML = playersHTML || '<p style="color: #666;">Todos en equipos</p>';
            
            let teamsHTML = '';
            Object.values(currentRoom.teams || {}).forEach(team => {
                const isMyTeam = currentTeam && currentTeam.id === team.id;
                const canJoin = !isMyTeam && currentPlayer && !team.members.includes(currentPlayer.id);
                teamsHTML += `<div class="team-card ${isMyTeam ? 'selected' : ''}" ${canJoin ? `onclick="joinTeam('${team.id}')"` : ''}><div class="team-name">${team.name} ${isMyTeam ? '‚úì' : ''}</div><div style="color: #666;">${team.members.length} miembro(s)</div></div>`;
            });
            document.getElementById('teams-list').innerHTML = teamsHTML || '<p style="color: #666;">No hay equipos</p>';
            
            if (currentTeam && currentRoom.teams && currentRoom.teams[currentTeam.id]) {
                const updatedTeam = currentRoom.teams[currentTeam.id];
                document.getElementById('my-team-name').textContent = updatedTeam.name;
                let membersHTML = '';
                updatedTeam.members.forEach(memberId => { const member = currentRoom.players[memberId]; if (member) membersHTML += `<span class="player-chip">${member.name}</span>`; });
                document.getElementById('my-team-members').innerHTML = membersHTML;
            }
            
            let allTeamsHTML = '';
            Object.values(currentRoom.teams || {}).forEach(team => {
                allTeamsHTML += `<div class="leaderboard-item"><div class="rank">${team.members.length}</div><div style="flex: 1; margin: 0 15px;"><strong>${team.name}</strong></div>${team.score > 0 ? `<div class="score">${team.score}</div>` : '<div style="color: #999;">---</div>'}</div>`;
            });
            document.getElementById('all-teams-list').innerHTML = allTeamsHTML || '<p style="text-align: center; color: #666;">Sin equipos</p>';
            
            if (!currentRoom || !currentRoom.votes) return;
            const voteCounts = {easy: 0, normal: 0, hard: 0};
            Object.values(currentRoom.votes).forEach(vote => voteCounts[vote]++);
            document.getElementById('votes-easy').textContent = voteCounts.easy;
            document.getElementById('votes-normal').textContent = voteCounts.normal;
            document.getElementById('votes-hard').textContent = voteCounts.hard;
            
            if (currentTeam && currentRoom.votes && currentRoom.votes[currentTeam.id]) {
                updateMyVoteDisplay(currentRoom.votes[currentTeam.id]);
            }
        }

        function showGame() {
            document.getElementById('lobby-screen').classList.remove('active');
            document.getElementById('game-screen').classList.add('active');
            document.getElementById('playing-team-name').textContent = currentTeam.name;
            updateStats();
            loadScenario(0);
        }

        function loadScenario(index) {
            const currentScenarios = scenariosByDifficulty[gameState.difficulty] || scenariosByDifficulty.normal;
            if (index >= currentScenarios.length) { loadFinalCase(); return; }
            gameState.currentScenario = index;
            const scenario = currentScenarios[index];
            let html = `<div class="scenario"><h3>${scenario.title}</h3><p style="color: #666;">${scenario.company}</p><p>${scenario.description}</p><div class="options">`;
            scenario.options.forEach((option, i) => {
                const disabled = option.cost > gameState.budget ? 'disabled' : '';
                html += `<button class="option-btn" onclick="selectOption(${index}, ${i})" ${disabled}>${option.text}<span class="option-cost">$${option.cost}K</span></button>`;
            });
            html += `</div><div id="feedback" class="feedback"></div></div>`;
            document.getElementById('scenario-container').innerHTML = html;
            startTimer();
        }

        function updateStats() {
            gameState.efficiency = Math.max(0, Math.min(100, gameState.efficiency));
            gameState.satisfaction = Math.max(0, Math.min(100, gameState.satisfaction));
            gameState.sustainability = Math.max(0, Math.min(100, gameState.sustainability));
            document.getElementById('efficiency').textContent = Math.round(gameState.efficiency) + '%';
            document.getElementById('costs').textContent = '$' + gameState.costs + 'K';
            document.getElementById('satisfaction').textContent = Math.round(gameState.satisfaction) + '%';
            document.getElementById('sustainability').textContent = Math.round(gameState.sustainability) + '%';
            document.getElementById('budget-text').textContent = gameState.budget;
            document.getElementById('budget-fill').style.width = ((gameState.budget / gameState.maxBudget) * 100) + '%';
        }

        function endGame() {
            stopTimer();
            const avgMetrics = (gameState.efficiency + gameState.satisfaction + gameState.sustainability) / 3;
            const finalScore = Math.round(gameState.score + avgMetrics);
            db.ref('rooms/' + currentRoom.code + '/teams/' + currentTeam.id).update({
                score: finalScore, 
                timeBonus: totalTimeBonus,
                status: 'finished'
            }).then(() => showResults());
        }

        function showResults() {
            document.getElementById('game-screen').classList.remove('active');
            document.getElementById('results-screen').classList.add('active');
            document.getElementById('results-team-name').textContent = currentTeam.name;
            document.getElementById('time-bonus').textContent = totalTimeBonus;
            db.ref('rooms/' + currentRoom.code + '/teams/' + currentTeam.id + '/score').once('value').then(snapshot => {
                document.getElementById('results-team-score').textContent = (snapshot.val() || 0) + ' pts';
            });
            db.ref('rooms/' + currentRoom.code + '/teams').once('value').then(snapshot => {
                const teams = snapshot.val() || {};
                const sortedTeams = Object.values(teams).filter(team => team.status === 'finished').sort((a, b) => (b.score || 0) - (a.score || 0));
                let html = '';
                sortedTeams.forEach((team, index) => {
                    const rankClass = index === 0 ? 'first' : '';
                    const medal = ['ü•á', 'ü•à', 'ü•â'][index] || (index + 1);
                    html += `<div class="leaderboard-item ${rankClass}"><div class="rank">${medal}</div><div style="flex: 1; margin: 0 15px;"><strong>${team.name}</strong><br><small style="color: #666;">Bonus: +${team.timeBonus || 0} pts</small></div><div class="score">${team.score || 0}</div></div>`;
                });
                document.getElementById('final-leaderboard').innerHTML = html || '<p style="text-align: center; color: #666;">Sin resultados</p>';
            });
        }

        function generateRoomCode() { const chars = 'ABCDEFGHJKLMNPQRSTUVWXYZ23456789'; let code = ''; for (let i = 0; i < 6; i++) code += chars.charAt(Math.floor(Math.random() * chars.length)); return code; }
        function generateId() { return Date.now().toString(36) + Math.random().toString(36).substr(2); }
    </script>
</body>
</html>